<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Car Experience</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400&display=swap" rel="stylesheet">
    
    <style>
        body { margin: 0; background-color: #050505; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        canvas { position: fixed; top: 0; left: 0; z-index: 1; pointer-events: none; }

        section {
            height: 100vh;
            display: flex;
            align-items: center;
            padding: 0 10%;
            position: relative;
            z-index: 2;
        }

        .content { max-width: 600px; opacity: 0; transform: translateY(50px); }
        .hero-content { opacity: 1; transform: translateY(0); }

        h1 { font-family: 'Playfair Display', serif; font-size: clamp(3rem, 8vw, 5rem); margin: 0; line-height: 1.1; }
        .gold { color: #d4af37; }
        p { color: #aaa; font-size: 1.2rem; margin: 20px 0; max-width: 400px; }

        .btn {
            padding: 15px 35px;
            background: #d4af37;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .right { justify-content: flex-end; text-align: right; }
        .right .content { margin-left: auto; }
    </style>
</head>
<body>

    <canvas id="car-canvas"></canvas>

    <section>
        <div class="content hero-content">
            <h1>PERFORMANCE <br><span class="gold">ABSOLUE</span></h1>
            <p>Découvrez l'ingénierie de pointe alliée au design intemporel.</p>
            <button class="btn">CONFIGURER</button>
        </div>
    </section>

    <section class="right">
        <div class="content" id="section-2">
            <h1 class="gold">AÉRODYNAMISME</h1>
            <p>Chaque ligne est sculptée pour réduire la traînée et augmenter la force d'appui.</p>
        </div>
    </section>

    <section>
        <div class="content" id="section-3">
            <h1>VITESSE <span class="gold">PURE</span></h1>
            <p>0 à 100 km/h en seulement 2.7 secondes. Une puissance sans compromis.</p>
            <button class="btn" style="background: transparent; border: 1px solid white; color: white;">ESSAYER</button>
        </div>
    </section>

    <script>
        // 1. SCÈNE THREE.JS
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('car-canvas'), antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);

        // Lumières
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        const spotLight = new THREE.SpotLight(0xffffff, 1);
        spotLight.position.set(5, 5, 5);
        scene.add(spotLight);

        // 2. CHARGEMENT DU MODÈLE (Porsche 911 d'exemple)
        let car;
        const loader = new THREE.GLTFLoader();
        loader.load('https://vazxmixjsiawhamofees.supabase.co/storage/v1/object/public/models/porsche-911-930-turbo/model.gltf', (gltf) => {
            car = gltf.scene;
            car.scale.set(1.5, 1.5, 1.5);
            car.rotation.y = Math.PI / 4;
            scene.add(car);
            animate();
        });

        camera.position.z = 5;

        // 3. ANIMATIONS AU SCROLL (GSAP)
        gsap.registerPlugin(ScrollTrigger);

        // Animation de la voiture (Rotation et Position)
        ScrollTrigger.create({
            trigger: "body",
            start: "top top",
            end: "bottom bottom",
            scrub: 1,
            onUpdate: (self) => {
                if (car) {
                    car.rotation.y = self.progress * Math.PI * 2; // Rotation complète
                    car.position.x = Math.sin(self.progress * 5) * 2; // Léger mouvement latéral
                }
            }
        });

        // Apparition des textes
        gsap.utils.toArray(".content").forEach(content => {
            gsap.to(content, {
                opacity: 1,
                y: 0,
                duration: 1,
                scrollTrigger: {
                    trigger: content,
                    start: "top 80%",
                    end: "top 20%",
                    scrub: true
                }
            });
        });

        // 4. BOUCLE D'ANIMATION
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        // Ajustement fenêtre
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
